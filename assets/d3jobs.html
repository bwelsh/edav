<!DOCTYPE html>
<meta charset="utf-8">
<title>Where the Jobs Are</title>
<style>

body {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  margin: auto;
  position: relative;
  width: 1060px;
}

text {
  font: 10px sans-serif;
}

.axis path,
.axis line {
  fill: none;
  stroke: #fff;
  shape-rendering: crispEdges;
}

form.mode {
  position: absolute;
  right: 10px;
  top: 50px;
}

div.tooltip {
  position: absolute;
  text-align: center;
  width: 85px;
  height: 95px;
  padding: 8px;
  font: 12px sans-serif;
  background: lightsteelblue;
  border: 0px;
  border-radius: 8px;
  pointer-events: none;
}

div.charttitle {
  font-size: 24pt;
  text-align: center;
  padding: 10px;
}

</style>
<body>
<div class="charttitle">Where the Jobs Are...</div>
<form class="mode">
  <label><input type="radio" name="mode" value="normal">Normalized</label>
  <label><input type="radio" name="mode" value="absolute" checked>Absolute</label>
</form>
<script src="http://mbostock.github.com/d3/d3.js?1.27.1"></script>
<script>
//Based on http://bl.ocks.org/mbostock/3943967 and http://tributary.io/inlet/4966973

//Raw data, output from my python script
//Data is from Bureau of Labor Statistics, seasonally adjusted non-farm payroll numbers
var all_data = [{"val68": {"subcat": "Education and health services", "name": "Social assistance", "value": 3.2704, "cat": "Services"}, "val69": {"subcat": "Leisure and hospitality", "name": "Performing arts and spectator sports", "value": 0.43060000000000004, "cat": "Services"}, "val66": {"subcat": "Education and health services", "name": "Hospitals", "value": 4.792800000000001, "cat": "Services"}, "val67": {"subcat": "Education and health services", "name": "Nursing and residential care facilities", "value": 3.2454, "cat": "Services"}, "val64": {"subcat": "Professional and business services", "name": "Waste management and remediation services", "value": 0.3747, "cat": "Services"}, "val65": {"subcat": "Education and health services", "name": "Ambulatory health care services", "value": 6.5666, "cat": "Services"}, "val62": {"subcat": "Financial activities", "name": "Lessors of nonfinancial intangible assets", "value": 0.0225, "cat": "Services"}, "val63": {"subcat": "Professional and business services", "name": "Administrative and support services", "value": 8.1491, "cat": "Services"}, "val60": {"subcat": "Financial activities", "name": "Real estate", "value": 1.4705, "cat": "Services"}, "val61": {"subcat": "Financial activities", "name": "Rental and leasing services", "value": 0.5266000000000001, "cat": "Services"}, "val59": {"subcat": "Financial activities", "name": "Insurance carriers and related activities", "value": 2.3988, "cat": "Services"}, "val58": {"subcat": "Financial activities", "name": "Credit intermediation and related activities", "value": 2.5958, "cat": "Services"}, "val53": {"subcat": "Information", "name": "Broadcasting, except Internet", "value": 0.2861, "cat": "Services"}, "val52": {"subcat": "Information", "name": "Motion picture and sound recording industries", "value": 0.3355, "cat": "Services"}, "val51": {"subcat": "Information", "name": "Publishing industries, except Internet", "value": 0.7309, "cat": "Services"}, "val50": {"subcat": "Transportation and warehousing", "name": "Warehousing and storage", "value": 0.7235, "cat": "Services"}, "val57": {"subcat": "Financial activities", "name": "Monetary authorities - central bank", "value": 0.0182, "cat": "Services"}, "val56": {"subcat": "Information", "name": "Other information services", "value": 0.1988, "cat": "Services"}, "val55": {"subcat": "Information", "name": "Data processing, hosting and related services", "value": 0.2698, "cat": "Services"}, "val54": {"subcat": "Information", "name": "Telecommunications", "value": 0.8576, "cat": "Services"}, "val9": {"subcat": "Durable Goods", "name": "Fabricated metal products", "value": 1.4459000000000002, "cat": "Goods"}, "val8": {"subcat": "Durable Goods", "name": "Primary metals", "value": 0.3973, "cat": "Goods"}, "year": 2013, "val3": {"subcat": "Construction", "name": "Construction of buildings", "value": 1.3152000000000001, "cat": "Goods"}, "val2": {"subcat": "Mining and logging", "name": "Support activities for mining", "value": 0.4146, "cat": "Goods"}, "val1": {"subcat": "Mining and logging", "name": "Mining, except oil and gas", "value": 0.21, "cat": "Goods"}, "val0": {"subcat": "Mining and logging", "name": "Oil and gas extraction", "value": 0.2042, "cat": "Goods"}, "val7": {"subcat": "Durable Goods", "name": "Nonmetallic mineral products", "value": 0.3782, "cat": "Goods"}, "val6": {"subcat": "Durable Goods", "name": "Wood products", "value": 0.358, "cat": "Goods"}, "val5": {"subcat": "Construction", "name": "Specialty trade contractors", "value": 3.6818, "cat": "Goods"}, "val4": {"subcat": "Construction", "name": "Heavy and civil engineering construction", "value": 0.8767, "cat": "Goods"}, "val44": {"subcat": "Transportation and warehousing", "name": "Truck transportation", "value": 1.3879000000000001, "cat": "Services"}, "val45": {"subcat": "Transportation and warehousing", "name": "Transit and ground passenger transportation", "value": 0.4536, "cat": "Services"}, "val46": {"subcat": "Transportation and warehousing", "name": "Pipeline transportation", "value": 0.044700000000000004, "cat": "Services"}, "val47": {"subcat": "Transportation and warehousing", "name": "Scenic and sightseeing transportation", "value": 0.0293, "cat": "Services"}, "val40": {"subcat": "Retail trade", "name": "Nonstore retailers", "value": 0.4694, "cat": "Services"}, "val41": {"subcat": "Transportation and warehousing", "name": "Air transportation", "value": 0.45389999999999997, "cat": "Services"}, "val42": {"subcat": "Transportation and warehousing", "name": "Rail transportation", "value": 0.233, "cat": "Services"}, "val43": {"subcat": "Transportation and warehousing", "name": "Water transportation", "value": 0.06609999999999999, "cat": "Services"}, "val48": {"subcat": "Transportation and warehousing", "name": "Support activities for transportation", "value": 0.5979, "cat": "Services"}, "val49": {"subcat": "Transportation and warehousing", "name": "Couriers and messengers", "value": 0.5628, "cat": "Services"}, "val31": {"subcat": "Retail trade", "name": "Electronics and appliance stores", "value": 0.5166000000000001, "cat": "Services"}, "val30": {"subcat": "Retail trade", "name": "Furniture and home furnishings stores", "value": 0.4485, "cat": "Services"}, "val33": {"subcat": "Retail trade", "name": "Food and beverage stores", "value": 2.9765, "cat": "Services"}, "val32": {"subcat": "Retail trade", "name": "Building material and garden supply stores", "value": 1.2232, "cat": "Services"}, "val35": {"subcat": "Retail trade", "name": "Gasoline stations", "value": 0.8724, "cat": "Services"}, "val34": {"subcat": "Retail trade", "name": "Health and personal care stores", "value": 1.0242, "cat": "Services"}, "val37": {"subcat": "Retail trade", "name": "Sporting goods, hobby, book, and music stores", "value": 0.6176, "cat": "Services"}, "val36": {"subcat": "Retail trade", "name": "Clothing and clothing accessories stores", "value": 1.4042000000000001, "cat": "Services"}, "val39": {"subcat": "Retail trade", "name": "Miscellaneous store retailers", "value": 0.7903, "cat": "Services"}, "val38": {"subcat": "Retail trade", "name": "General merchandise stores", "value": 3.106, "cat": "Services"}, "val22": {"subcat": "Nondurable Goods", "name": "Petroleum and coal products", "value": 0.11109999999999999, "cat": "Goods"}, "val23": {"subcat": "Nondurable Goods", "name": "Chemicals", "value": 0.7948999999999999, "cat": "Goods"}, "val20": {"subcat": "Nondurable Goods", "name": "Paper and paper products", "value": 0.3777, "cat": "Goods"}, "val21": {"subcat": "Nondurable Goods", "name": "Printing and related support activities", "value": 0.4433, "cat": "Goods"}, "val26": {"subcat": "Wholesale trade", "name": "Durable goods", "value": 2.8951, "cat": "Services"}, "val27": {"subcat": "Wholesale trade", "name": "Nondurable goods", "value": 1.9932, "cat": "Services"}, "val24": {"subcat": "Nondurable Goods", "name": "Plastics and rubber products", "value": 0.6604, "cat": "Goods"}, "val25": {"subcat": "Nondurable Goods", "name": "Leather and allied products", "value": 0.0289, "cat": "Goods"}, "val28": {"subcat": "Wholesale trade", "name": "Electronic markets and agents and brokers", "value": 0.9077000000000001, "cat": "Services"}, "val29": {"subcat": "Retail trade", "name": "Motor vehicle and parts dealers", "value": 1.8235, "cat": "Services"}, "val19": {"subcat": "Nondurable Goods", "name": "Apparel", "value": 0.1391, "cat": "Goods"}, "val18": {"subcat": "Nondurable Goods", "name": "Textile product mills", "value": 0.1119, "cat": "Goods"}, "val17": {"subcat": "Nondurable Goods", "name": "Textile mills", "value": 0.1178, "cat": "Goods"}, "val16": {"subcat": "Nondurable Goods", "name": "Food manufacturing", "value": 1.4844000000000002, "cat": "Goods"}, "val15": {"subcat": "Durable Goods", "name": "Miscellaneous durable goods manufacturing", "value": 0.5801000000000001, "cat": "Goods"}, "val14": {"subcat": "Durable Goods", "name": "Furniture and related products", "value": 0.3643, "cat": "Goods"}, "val13": {"subcat": "Durable Goods", "name": "Transportation equipment", "value": 1.5198, "cat": "Goods"}, "val12": {"subcat": "Durable Goods", "name": "Electrical equipment and appliances", "value": 0.3755, "cat": "Goods"}, "val11": {"subcat": "Durable Goods", "name": "Computer and electronic products", "value": 1.0577, "cat": "Goods"}, "val10": {"subcat": "Durable Goods", "name": "Machinery", "value": 1.1064, "cat": "Goods"}, "val90": {"subcat": "Local", "name": "Other local government", "value": 1.0649000000000002, "cat": "Government"}, "val80": {"subcat": "Federal", "name": "Other Federal government", "value": 1.3023, "cat": "Government"}, "val81": {"subcat": "State", "name": "State government education", "value": 2.4061999999999997, "cat": "Government"}, "val82": {"subcat": "State", "name": "State hospitals", "value": 0.3547, "cat": "Government"}, "val83": {"subcat": "State", "name": "State government general administration", "value": 1.8045, "cat": "Government"}, "val84": {"subcat": "State", "name": "Other State government", "value": 0.49310000000000004, "cat": "Government"}, "val85": {"subcat": "Local", "name": "Local government education", "value": 7.765899999999999, "cat": "Government"}, "val86": {"subcat": "Local", "name": "Local government utilities", "value": 0.2386, "cat": "Government"}, "val87": {"subcat": "Local", "name": "Local government transportation", "value": 0.2914, "cat": "Government"}, "val88": {"subcat": "Local", "name": "Local hospitals", "value": 0.6516000000000001, "cat": "Government"}, "val89": {"subcat": "Local", "name": "Local government general administration", "value": 4.0363, "cat": "Government"}, "val79": {"subcat": "Federal", "name": "U.S. Postal Service", "value": 0.5943999999999999, "cat": "Government"}, "val78": {"subcat": "Federal", "name": "Department of Defense", "value": 0.5246000000000001, "cat": "Government"}, "val75": {"subcat": "Other services", "name": "Personal and laundry services", "value": 1.3492, "cat": "Services"}, "val74": {"subcat": "Other services", "name": "Repair and maintenance", "value": 1.2118, "cat": "Services"}, "val77": {"subcat": "Federal", "name": "Federal hospitals", "value": 0.3145, "cat": "Government"}, "val76": {"subcat": "Other services", "name": "Membership associations and organizations", "value": 2.9189000000000003, "cat": "Services"}, "val71": {"subcat": "Leisure and hospitality", "name": "Amusements, gambling, and recreation", "value": 1.5112999999999999, "cat": "Services"}, "val70": {"subcat": "Leisure and hospitality", "name": "Museums, historical sites, and similar institutions", "value": 0.1411, "cat": "Services"}, "val73": {"subcat": "Leisure and hospitality", "name": "Food services and drinking places", "value": 10.4888, "cat": "Services"}, "val72": {"subcat": "Leisure and hospitality", "name": "Accommodation", "value": 1.8656, "cat": "Services"}}, {"val68": {"subcat": "Education and health services", "name": "Social assistance", "value": 2.9486999999999997, "cat": "Services"}, "val69": {"subcat": "Leisure and hospitality", "name": "Performing arts and spectator sports", "value": 0.3915, "cat": "Services"}, "val66": {"subcat": "Education and health services", "name": "Hospitals", "value": 4.6707, "cat": "Services"}, "val67": {"subcat": "Education and health services", "name": "Nursing and residential care facilities", "value": 3.1024000000000003, "cat": "Services"}, "val64": {"subcat": "Professional and business services", "name": "Waste management and remediation services", "value": 0.351, "cat": "Services"}, "val65": {"subcat": "Education and health services", "name": "Ambulatory health care services", "value": 5.881600000000001, "cat": "Services"}, "val62": {"subcat": "Financial activities", "name": "Lessors of nonfinancial intangible assets", "value": 0.0261, "cat": "Services"}, "val63": {"subcat": "Professional and business services", "name": "Administrative and support services", "value": 6.849, "cat": "Services"}, "val60": {"subcat": "Financial activities", "name": "Real estate", "value": 1.4105, "cat": "Services"}, "val61": {"subcat": "Financial activities", "name": "Rental and leasing services", "value": 0.5224, "cat": "Services"}, "val59": {"subcat": "Financial activities", "name": "Insurance carriers and related activities", "value": 2.3607, "cat": "Services"}, "val58": {"subcat": "Financial activities", "name": "Credit intermediation and related activities", "value": 2.5509, "cat": "Services"}, "val53": {"subcat": "Information", "name": "Broadcasting, except Internet", "value": 0.2936, "cat": "Services"}, "val52": {"subcat": "Information", "name": "Motion picture and sound recording industries", "value": 0.3635, "cat": "Services"}, "val51": {"subcat": "Information", "name": "Publishing industries, except Internet", "value": 0.7702, "cat": "Services"}, "val50": {"subcat": "Transportation and warehousing", "name": "Warehousing and storage", "value": 0.6205, "cat": "Services"}, "val57": {"subcat": "Financial activities", "name": "Monetary authorities - central bank", "value": 0.0206, "cat": "Services"}, "val56": {"subcat": "Information", "name": "Other information services", "value": 0.1366, "cat": "Services"}, "val55": {"subcat": "Information", "name": "Data processing, hosting and related services", "value": 0.24559999999999998, "cat": "Services"}, "val54": {"subcat": "Information", "name": "Telecommunications", "value": 0.9341, "cat": "Services"}, "val9": {"subcat": "Durable Goods", "name": "Fabricated metal products", "value": 1.2586, "cat": "Goods"}, "val8": {"subcat": "Durable Goods", "name": "Primary metals", "value": 0.3472, "cat": "Goods"}, "year": 2009, "val3": {"subcat": "Construction", "name": "Construction of buildings", "value": 1.2628, "cat": "Goods"}, "val2": {"subcat": "Mining and logging", "name": "Support activities for mining", "value": 0.25930000000000003, "cat": "Goods"}, "val1": {"subcat": "Mining and logging", "name": "Mining, except oil and gas", "value": 0.1995, "cat": "Goods"}, "val0": {"subcat": "Mining and logging", "name": "Oil and gas extraction", "value": 0.15530000000000002, "cat": "Goods"}, "val7": {"subcat": "Durable Goods", "name": "Nonmetallic mineral products", "value": 0.37610000000000005, "cat": "Goods"}, "val6": {"subcat": "Durable Goods", "name": "Wood products", "value": 0.3457, "cat": "Goods"}, "val5": {"subcat": "Construction", "name": "Specialty trade contractors", "value": 3.5814, "cat": "Goods"}, "val4": {"subcat": "Construction", "name": "Heavy and civil engineering construction", "value": 0.8097000000000001, "cat": "Goods"}, "val44": {"subcat": "Transportation and warehousing", "name": "Truck transportation", "value": 1.2412, "cat": "Services"}, "val45": {"subcat": "Transportation and warehousing", "name": "Transit and ground passenger transportation", "value": 0.4189, "cat": "Services"}, "val46": {"subcat": "Transportation and warehousing", "name": "Pipeline transportation", "value": 0.0427, "cat": "Services"}, "val47": {"subcat": "Transportation and warehousing", "name": "Scenic and sightseeing transportation", "value": 0.0281, "cat": "Services"}, "val40": {"subcat": "Retail trade", "name": "Nonstore retailers", "value": 0.4172, "cat": "Services"}, "val41": {"subcat": "Transportation and warehousing", "name": "Air transportation", "value": 0.4606, "cat": "Services"}, "val42": {"subcat": "Transportation and warehousing", "name": "Rail transportation", "value": 0.2114, "cat": "Services"}, "val43": {"subcat": "Transportation and warehousing", "name": "Water transportation", "value": 0.0625, "cat": "Services"}, "val48": {"subcat": "Transportation and warehousing", "name": "Support activities for transportation", "value": 0.5378999999999999, "cat": "Services"}, "val49": {"subcat": "Transportation and warehousing", "name": "Couriers and messengers", "value": 0.49339999999999995, "cat": "Services"}, "val31": {"subcat": "Retail trade", "name": "Electronics and appliance stores", "value": 0.5097, "cat": "Services"}, "val30": {"subcat": "Retail trade", "name": "Furniture and home furnishings stores", "value": 0.43860000000000005, "cat": "Services"}, "val33": {"subcat": "Retail trade", "name": "Food and beverage stores", "value": 2.8022, "cat": "Services"}, "val32": {"subcat": "Retail trade", "name": "Building material and garden supply stores", "value": 1.1378, "cat": "Services"}, "val35": {"subcat": "Retail trade", "name": "Gasoline stations", "value": 0.8186, "cat": "Services"}, "val34": {"subcat": "Retail trade", "name": "Health and personal care stores", "value": 0.9827, "cat": "Services"}, "val37": {"subcat": "Retail trade", "name": "Sporting goods, hobby, book, and music stores", "value": 0.5804, "cat": "Services"}, "val36": {"subcat": "Retail trade", "name": "Clothing and clothing accessories stores", "value": 1.3326, "cat": "Services"}, "val39": {"subcat": "Retail trade", "name": "Miscellaneous store retailers", "value": 0.7672, "cat": "Services"}, "val38": {"subcat": "Retail trade", "name": "General merchandise stores", "value": 2.9206999999999996, "cat": "Services"}, "val22": {"subcat": "Nondurable Goods", "name": "Petroleum and coal products", "value": 0.1115, "cat": "Goods"}, "val23": {"subcat": "Nondurable Goods", "name": "Chemicals", "value": 0.7943, "cat": "Goods"}, "val20": {"subcat": "Nondurable Goods", "name": "Paper and paper products", "value": 0.3969, "cat": "Goods"}, "val21": {"subcat": "Nondurable Goods", "name": "Printing and related support activities", "value": 0.49710000000000004, "cat": "Goods"}, "val26": {"subcat": "Wholesale trade", "name": "Durable goods", "value": 2.7266, "cat": "Services"}, "val27": {"subcat": "Wholesale trade", "name": "Nondurable goods", "value": 1.9432, "cat": "Services"}, "val24": {"subcat": "Nondurable Goods", "name": "Plastics and rubber products", "value": 0.6112000000000001, "cat": "Goods"}, "val25": {"subcat": "Nondurable Goods", "name": "Leather and allied products", "value": 0.027399999999999997, "cat": "Goods"}, "val28": {"subcat": "Wholesale trade", "name": "Electronic markets and agents and brokers", "value": 0.8052999999999999, "cat": "Services"}, "val29": {"subcat": "Retail trade", "name": "Motor vehicle and parts dealers", "value": 1.6168, "cat": "Services"}, "val19": {"subcat": "Nondurable Goods", "name": "Apparel", "value": 0.1601, "cat": "Goods"}, "val18": {"subcat": "Nondurable Goods", "name": "Textile product mills", "value": 0.12029999999999999, "cat": "Goods"}, "val17": {"subcat": "Nondurable Goods", "name": "Textile mills", "value": 0.1211, "cat": "Goods"}, "val16": {"subcat": "Nondurable Goods", "name": "Food manufacturing", "value": 1.4533, "cat": "Goods"}, "val15": {"subcat": "Durable Goods", "name": "Miscellaneous durable goods manufacturing", "value": 0.5695, "cat": "Goods"}, "val14": {"subcat": "Durable Goods", "name": "Furniture and related products", "value": 0.36310000000000003, "cat": "Goods"}, "val13": {"subcat": "Durable Goods", "name": "Transportation equipment", "value": 1.3135999999999999, "cat": "Goods"}, "val12": {"subcat": "Durable Goods", "name": "Electrical equipment and appliances", "value": 0.3544, "cat": "Goods"}, "val11": {"subcat": "Durable Goods", "name": "Computer and electronic products", "value": 1.0963, "cat": "Goods"}, "val10": {"subcat": "Durable Goods", "name": "Machinery", "value": 0.9766, "cat": "Goods"}, "val90": {"subcat": "Local", "name": "Other local government", "value": 1.095, "cat": "Government"}, "val80": {"subcat": "Federal", "name": "Other Federal government", "value": 1.3413, "cat": "Government"}, "val81": {"subcat": "State", "name": "State government education", "value": 2.3587, "cat": "Government"}, "val82": {"subcat": "State", "name": "State hospitals", "value": 0.3573, "cat": "Government"}, "val83": {"subcat": "State", "name": "State government general administration", "value": 1.9099000000000002, "cat": "Government"}, "val84": {"subcat": "State", "name": "Other State government", "value": 0.5239, "cat": "Government"}, "val85": {"subcat": "Local", "name": "Local government education", "value": 8.0716, "cat": "Government"}, "val86": {"subcat": "Local", "name": "Local government utilities", "value": 0.2449, "cat": "Government"}, "val87": {"subcat": "Local", "name": "Local government transportation", "value": 0.267, "cat": "Government"}, "val88": {"subcat": "Local", "name": "Local hospitals", "value": 0.6557000000000001, "cat": "Government"}, "val89": {"subcat": "Local", "name": "Local government general administration", "value": 4.1655, "cat": "Government"}, "val79": {"subcat": "Federal", "name": "U.S. Postal Service", "value": 0.661, "cat": "Government"}, "val78": {"subcat": "Federal", "name": "Department of Defense", "value": 0.5327999999999999, "cat": "Government"}, "val75": {"subcat": "Other services", "name": "Personal and laundry services", "value": 1.2641, "cat": "Services"}, "val74": {"subcat": "Other services", "name": "Repair and maintenance", "value": 1.1320999999999999, "cat": "Services"}, "val77": {"subcat": "Federal", "name": "Federal hospitals", "value": 0.29669999999999996, "cat": "Government"}, "val76": {"subcat": "Other services", "name": "Membership associations and organizations", "value": 2.9234, "cat": "Services"}, "val71": {"subcat": "Leisure and hospitality", "name": "Amusements, gambling, and recreation", "value": 1.3714000000000002, "cat": "Services"}, "val70": {"subcat": "Leisure and hospitality", "name": "Museums, historical sites, and similar institutions", "value": 0.128, "cat": "Services"}, "val73": {"subcat": "Leisure and hospitality", "name": "Food services and drinking places", "value": 9.3045, "cat": "Services"}, "val72": {"subcat": "Leisure and hospitality", "name": "Accommodation", "value": 1.7487000000000001, "cat": "Services"}}, {"val68": {"subcat": "Education and health services", "name": "Social assistance", "value": 2.54, "cat": "Services"}, "val69": {"subcat": "Leisure and hospitality", "name": "Performing arts and spectator sports", "value": 0.3805, "cat": "Services"}, "val66": {"subcat": "Education and health services", "name": "Hospitals", "value": 4.3792, "cat": "Services"}, "val67": {"subcat": "Education and health services", "name": "Nursing and residential care facilities", "value": 2.8691999999999998, "cat": "Services"}, "val64": {"subcat": "Professional and business services", "name": "Waste management and remediation services", "value": 0.3413, "cat": "Services"}, "val65": {"subcat": "Education and health services", "name": "Ambulatory health care services", "value": 5.1872, "cat": "Services"}, "val62": {"subcat": "Financial activities", "name": "Lessors of nonfinancial intangible assets", "value": 0.0277, "cat": "Services"}, "val63": {"subcat": "Professional and business services", "name": "Administrative and support services", "value": 7.9693000000000005, "cat": "Services"}, "val60": {"subcat": "Financial activities", "name": "Real estate", "value": 1.4886, "cat": "Services"}, "val61": {"subcat": "Financial activities", "name": "Rental and leasing services", "value": 0.6419, "cat": "Services"}, "val59": {"subcat": "Financial activities", "name": "Insurance carriers and related activities", "value": 2.3601, "cat": "Services"}, "val58": {"subcat": "Financial activities", "name": "Credit intermediation and related activities", "value": 2.9027, "cat": "Services"}, "val53": {"subcat": "Information", "name": "Broadcasting, except Internet", "value": 0.3275, "cat": "Services"}, "val52": {"subcat": "Information", "name": "Motion picture and sound recording industries", "value": 0.38430000000000003, "cat": "Services"}, "val51": {"subcat": "Information", "name": "Publishing industries, except Internet", "value": 0.9031, "cat": "Services"}, "val50": {"subcat": "Transportation and warehousing", "name": "Warehousing and storage", "value": 0.6159, "cat": "Services"}, "val57": {"subcat": "Financial activities", "name": "Monetary authorities - central bank", "value": 0.021, "cat": "Services"}, "val56": {"subcat": "Information", "name": "Other information services", "value": 0.1202, "cat": "Services"}, "val55": {"subcat": "Information", "name": "Data processing, hosting and related services", "value": 0.26239999999999997, "cat": "Services"}, "val54": {"subcat": "Information", "name": "Telecommunications", "value": 1.0563, "cat": "Services"}, "val9": {"subcat": "Durable Goods", "name": "Fabricated metal products", "value": 1.532, "cat": "Goods"}, "val8": {"subcat": "Durable Goods", "name": "Primary metals", "value": 0.4638, "cat": "Goods"}, "year": 2005, "val3": {"subcat": "Construction", "name": "Construction of buildings", "value": 1.7712999999999999, "cat": "Goods"}, "val2": {"subcat": "Mining and logging", "name": "Support activities for mining", "value": 0.2407, "cat": "Goods"}, "val1": {"subcat": "Mining and logging", "name": "Mining, except oil and gas", "value": 0.2165, "cat": "Goods"}, "val0": {"subcat": "Mining and logging", "name": "Oil and gas extraction", "value": 0.1281, "cat": "Goods"}, "val7": {"subcat": "Durable Goods", "name": "Nonmetallic mineral products", "value": 0.5053, "cat": "Goods"}, "val6": {"subcat": "Durable Goods", "name": "Wood products", "value": 0.5717000000000001, "cat": "Goods"}, "val5": {"subcat": "Construction", "name": "Specialty trade contractors", "value": 4.7995, "cat": "Goods"}, "val4": {"subcat": "Construction", "name": "Heavy and civil engineering construction", "value": 0.9622, "cat": "Goods"}, "val44": {"subcat": "Transportation and warehousing", "name": "Truck transportation", "value": 1.4141, "cat": "Services"}, "val45": {"subcat": "Transportation and warehousing", "name": "Transit and ground passenger transportation", "value": 0.395, "cat": "Services"}, "val46": {"subcat": "Transportation and warehousing", "name": "Pipeline transportation", "value": 0.037700000000000004, "cat": "Services"}, "val47": {"subcat": "Transportation and warehousing", "name": "Scenic and sightseeing transportation", "value": 0.027100000000000003, "cat": "Services"}, "val40": {"subcat": "Retail trade", "name": "Nonstore retailers", "value": 0.4353, "cat": "Services"}, "val41": {"subcat": "Transportation and warehousing", "name": "Air transportation", "value": 0.4849, "cat": "Services"}, "val42": {"subcat": "Transportation and warehousing", "name": "Rail transportation", "value": 0.2261, "cat": "Services"}, "val43": {"subcat": "Transportation and warehousing", "name": "Water transportation", "value": 0.0632, "cat": "Services"}, "val48": {"subcat": "Transportation and warehousing", "name": "Support activities for transportation", "value": 0.5606, "cat": "Services"}, "val49": {"subcat": "Transportation and warehousing", "name": "Couriers and messengers", "value": 0.5797, "cat": "Services"}, "val31": {"subcat": "Retail trade", "name": "Electronics and appliance stores", "value": 0.5941000000000001, "cat": "Services"}, "val30": {"subcat": "Retail trade", "name": "Furniture and home furnishings stores", "value": 0.5782999999999999, "cat": "Services"}, "val33": {"subcat": "Retail trade", "name": "Food and beverage stores", "value": 2.8169, "cat": "Services"}, "val32": {"subcat": "Retail trade", "name": "Building material and garden supply stores", "value": 1.2999, "cat": "Services"}, "val35": {"subcat": "Retail trade", "name": "Gasoline stations", "value": 0.8692000000000001, "cat": "Services"}, "val34": {"subcat": "Retail trade", "name": "Health and personal care stores", "value": 0.9622, "cat": "Services"}, "val37": {"subcat": "Retail trade", "name": "Sporting goods, hobby, book, and music stores", "value": 0.6023, "cat": "Services"}, "val36": {"subcat": "Retail trade", "name": "Clothing and clothing accessories stores", "value": 1.4325999999999999, "cat": "Services"}, "val39": {"subcat": "Retail trade", "name": "Miscellaneous store retailers", "value": 0.8902, "cat": "Services"}, "val38": {"subcat": "Retail trade", "name": "General merchandise stores", "value": 2.9482, "cat": "Services"}, "val22": {"subcat": "Nondurable Goods", "name": "Petroleum and coal products", "value": 0.111, "cat": "Goods"}, "val23": {"subcat": "Nondurable Goods", "name": "Chemicals", "value": 0.8667999999999999, "cat": "Goods"}, "val20": {"subcat": "Nondurable Goods", "name": "Paper and paper products", "value": 0.4764, "cat": "Goods"}, "val21": {"subcat": "Nondurable Goods", "name": "Printing and related support activities", "value": 0.6397, "cat": "Goods"}, "val26": {"subcat": "Wholesale trade", "name": "Durable goods", "value": 3.0341, "cat": "Services"}, "val27": {"subcat": "Wholesale trade", "name": "Nondurable goods", "value": 2.0224, "cat": "Services"}, "val24": {"subcat": "Nondurable Goods", "name": "Plastics and rubber products", "value": 0.8048, "cat": "Goods"}, "val25": {"subcat": "Nondurable Goods", "name": "Leather and allied products", "value": 0.04, "cat": "Goods"}, "val28": {"subcat": "Wholesale trade", "name": "Electronic markets and agents and brokers", "value": 0.7597, "cat": "Services"}, "val29": {"subcat": "Retail trade", "name": "Motor vehicle and parts dealers", "value": 1.9152, "cat": "Services"}, "val19": {"subcat": "Nondurable Goods", "name": "Apparel", "value": 0.2396, "cat": "Goods"}, "val18": {"subcat": "Nondurable Goods", "name": "Textile product mills", "value": 0.173, "cat": "Goods"}, "val17": {"subcat": "Nondurable Goods", "name": "Textile mills", "value": 0.2079, "cat": "Goods"}, "val16": {"subcat": "Nondurable Goods", "name": "Food manufacturing", "value": 1.4761, "cat": "Goods"}, "val15": {"subcat": "Durable Goods", "name": "Miscellaneous durable goods manufacturing", "value": 0.6445, "cat": "Goods"}, "val14": {"subcat": "Durable Goods", "name": "Furniture and related products", "value": 0.5651, "cat": "Goods"}, "val13": {"subcat": "Durable Goods", "name": "Transportation equipment", "value": 1.7735999999999998, "cat": "Goods"}, "val12": {"subcat": "Durable Goods", "name": "Electrical equipment and appliances", "value": 0.43010000000000004, "cat": "Goods"}, "val11": {"subcat": "Durable Goods", "name": "Computer and electronic products", "value": 1.3117999999999999, "cat": "Goods"}, "val10": {"subcat": "Durable Goods", "name": "Machinery", "value": 1.1685, "cat": "Goods"}, "val90": {"subcat": "Local", "name": "Other local government", "value": 1.028, "cat": "Government"}, "val80": {"subcat": "Federal", "name": "Other Federal government", "value": 1.2182, "cat": "Government"}, "val81": {"subcat": "State", "name": "State government education", "value": 2.2826999999999997, "cat": "Government"}, "val82": {"subcat": "State", "name": "State hospitals", "value": 0.3558, "cat": "Government"}, "val83": {"subcat": "State", "name": "State government general administration", "value": 1.8678, "cat": "Government"}, "val84": {"subcat": "State", "name": "Other State government", "value": 0.5547000000000001, "cat": "Government"}, "val85": {"subcat": "Local", "name": "Local government education", "value": 7.883, "cat": "Government"}, "val86": {"subcat": "Local", "name": "Local government utilities", "value": 0.2384, "cat": "Government"}, "val87": {"subcat": "Local", "name": "Local government transportation", "value": 0.2531, "cat": "Government"}, "val88": {"subcat": "Local", "name": "Local hospitals", "value": 0.6479, "cat": "Government"}, "val89": {"subcat": "Local", "name": "Local government general administration", "value": 4.0333000000000006, "cat": "Government"}, "val79": {"subcat": "Federal", "name": "U.S. Postal Service", "value": 0.7752, "cat": "Government"}, "val78": {"subcat": "Federal", "name": "Department of Defense", "value": 0.4905, "cat": "Government"}, "val75": {"subcat": "Other services", "name": "Personal and laundry services", "value": 1.2789000000000001, "cat": "Services"}, "val74": {"subcat": "Other services", "name": "Repair and maintenance", "value": 1.2395999999999998, "cat": "Services"}, "val77": {"subcat": "Federal", "name": "Federal hospitals", "value": 0.2479, "cat": "Government"}, "val76": {"subcat": "Other services", "name": "Membership associations and organizations", "value": 2.8866, "cat": "Services"}, "val71": {"subcat": "Leisure and hospitality", "name": "Amusements, gambling, and recreation", "value": 1.4002000000000001, "cat": "Services"}, "val70": {"subcat": "Leisure and hospitality", "name": "Museums, historical sites, and similar institutions", "value": 0.1212, "cat": "Services"}, "val73": {"subcat": "Leisure and hospitality", "name": "Food services and drinking places", "value": 9.1826, "cat": "Services"}, "val72": {"subcat": "Leisure and hospitality", "name": "Accommodation", "value": 1.8202, "cat": "Services"}}, {"val68": {"subcat": "Education and health services", "name": "Social assistance", "value": 2.1588000000000003, "cat": "Services"}, "val69": {"subcat": "Leisure and hospitality", "name": "Performing arts and spectator sports", "value": 0.3788, "cat": "Services"}, "val66": {"subcat": "Education and health services", "name": "Hospitals", "value": 4.1051, "cat": "Services"}, "val67": {"subcat": "Education and health services", "name": "Nursing and residential care facilities", "value": 2.7161, "cat": "Services"}, "val64": {"subcat": "Professional and business services", "name": "Waste management and remediation services", "value": 0.31939999999999996, "cat": "Services"}, "val65": {"subcat": "Education and health services", "name": "Ambulatory health care services", "value": 4.5363999999999995, "cat": "Services"}, "val62": {"subcat": "Financial activities", "name": "Lessors of nonfinancial intangible assets", "value": 0.028399999999999998, "cat": "Services"}, "val63": {"subcat": "Professional and business services", "name": "Administrative and support services", "value": 7.2595, "cat": "Services"}, "val60": {"subcat": "Financial activities", "name": "Real estate", "value": 1.3523, "cat": "Services"}, "val61": {"subcat": "Financial activities", "name": "Rental and leasing services", "value": 0.6507999999999999, "cat": "Services"}, "val59": {"subcat": "Financial activities", "name": "Insurance carriers and related activities", "value": 2.3733, "cat": "Services"}, "val58": {"subcat": "Financial activities", "name": "Credit intermediation and related activities", "value": 2.6473, "cat": "Services"}, "val53": {"subcat": "Information", "name": "Broadcasting, except Internet", "value": 0.341, "cat": "Services"}, "val52": {"subcat": "Information", "name": "Motion picture and sound recording industries", "value": 0.3822, "cat": "Services"}, "val51": {"subcat": "Information", "name": "Publishing industries, except Internet", "value": 0.9901, "cat": "Services"}, "val50": {"subcat": "Transportation and warehousing", "name": "Warehousing and storage", "value": 0.5042, "cat": "Services"}, "val57": {"subcat": "Financial activities", "name": "Monetary authorities - central bank", "value": 0.0233, "cat": "Services"}, "val56": {"subcat": "Information", "name": "Other information services", "value": 0.1323, "cat": "Services"}, "val55": {"subcat": "Information", "name": "Data processing, hosting and related services", "value": 0.312, "cat": "Services"}, "val54": {"subcat": "Information", "name": "Telecommunications", "value": 1.363, "cat": "Services"}, "val9": {"subcat": "Durable Goods", "name": "Fabricated metal products", "value": 1.589, "cat": "Goods"}, "val8": {"subcat": "Durable Goods", "name": "Primary metals", "value": 0.5297000000000001, "cat": "Goods"}, "year": 2001, "val3": {"subcat": "Construction", "name": "Construction of buildings", "value": 1.5844, "cat": "Goods"}, "val2": {"subcat": "Mining and logging", "name": "Support activities for mining", "value": 0.1839, "cat": "Goods"}, "val1": {"subcat": "Mining and logging", "name": "Mining, except oil and gas", "value": 0.2174, "cat": "Goods"}, "val0": {"subcat": "Mining and logging", "name": "Oil and gas extraction", "value": 0.1247, "cat": "Goods"}, "val7": {"subcat": "Durable Goods", "name": "Nonmetallic mineral products", "value": 0.5306000000000001, "cat": "Goods"}, "val6": {"subcat": "Durable Goods", "name": "Wood products", "value": 0.5642, "cat": "Goods"}, "val5": {"subcat": "Construction", "name": "Specialty trade contractors", "value": 4.2459, "cat": "Goods"}, "val4": {"subcat": "Construction", "name": "Heavy and civil engineering construction", "value": 0.9546, "cat": "Goods"}, "val44": {"subcat": "Transportation and warehousing", "name": "Truck transportation", "value": 1.3563, "cat": "Services"}, "val45": {"subcat": "Transportation and warehousing", "name": "Transit and ground passenger transportation", "value": 0.3679, "cat": "Services"}, "val46": {"subcat": "Transportation and warehousing", "name": "Pipeline transportation", "value": 0.0437, "cat": "Services"}, "val47": {"subcat": "Transportation and warehousing", "name": "Scenic and sightseeing transportation", "value": 0.027800000000000002, "cat": "Services"}, "val40": {"subcat": "Retail trade", "name": "Nonstore retailers", "value": 0.4482, "cat": "Services"}, "val41": {"subcat": "Transportation and warehousing", "name": "Air transportation", "value": 0.56, "cat": "Services"}, "val42": {"subcat": "Transportation and warehousing", "name": "Rail transportation", "value": 0.2246, "cat": "Services"}, "val43": {"subcat": "Transportation and warehousing", "name": "Water transportation", "value": 0.0535, "cat": "Services"}, "val48": {"subcat": "Transportation and warehousing", "name": "Support activities for transportation", "value": 0.5244, "cat": "Services"}, "val49": {"subcat": "Transportation and warehousing", "name": "Couriers and messengers", "value": 0.5775, "cat": "Services"}, "val31": {"subcat": "Retail trade", "name": "Electronics and appliance stores", "value": 0.6147999999999999, "cat": "Services"}, "val30": {"subcat": "Retail trade", "name": "Furniture and home furnishings stores", "value": 0.5347000000000001, "cat": "Services"}, "val33": {"subcat": "Retail trade", "name": "Food and beverage stores", "value": 2.9278000000000004, "cat": "Services"}, "val32": {"subcat": "Retail trade", "name": "Building material and garden supply stores", "value": 1.1668, "cat": "Services"}, "val35": {"subcat": "Retail trade", "name": "Gasoline stations", "value": 0.9168, "cat": "Services"}, "val34": {"subcat": "Retail trade", "name": "Health and personal care stores", "value": 0.9464, "cat": "Services"}, "val37": {"subcat": "Retail trade", "name": "Sporting goods, hobby, book, and music stores", "value": 0.5699, "cat": "Services"}, "val36": {"subcat": "Retail trade", "name": "Clothing and clothing accessories stores", "value": 1.3015999999999999, "cat": "Services"}, "val39": {"subcat": "Retail trade", "name": "Miscellaneous store retailers", "value": 0.9775, "cat": "Services"}, "val38": {"subcat": "Retail trade", "name": "General merchandise stores", "value": 2.8173000000000004, "cat": "Services"}, "val22": {"subcat": "Nondurable Goods", "name": "Petroleum and coal products", "value": 0.1201, "cat": "Goods"}, "val23": {"subcat": "Nondurable Goods", "name": "Chemicals", "value": 0.9402999999999999, "cat": "Goods"}, "val20": {"subcat": "Nondurable Goods", "name": "Paper and paper products", "value": 0.5599, "cat": "Goods"}, "val21": {"subcat": "Nondurable Goods", "name": "Printing and related support activities", "value": 0.7365, "cat": "Goods"}, "val26": {"subcat": "Wholesale trade", "name": "Durable goods", "value": 3.0559000000000003, "cat": "Services"}, "val27": {"subcat": "Wholesale trade", "name": "Nondurable goods", "value": 2.0193, "cat": "Services"}, "val24": {"subcat": "Nondurable Goods", "name": "Plastics and rubber products", "value": 0.8592000000000001, "cat": "Goods"}, "val25": {"subcat": "Nondurable Goods", "name": "Leather and allied products", "value": 0.0528, "cat": "Goods"}, "val28": {"subcat": "Wholesale trade", "name": "Electronic markets and agents and brokers", "value": 0.6195, "cat": "Services"}, "val29": {"subcat": "Retail trade", "name": "Motor vehicle and parts dealers", "value": 1.8689, "cat": "Services"}, "val19": {"subcat": "Nondurable Goods", "name": "Apparel", "value": 0.3713, "cat": "Goods"}, "val18": {"subcat": "Nondurable Goods", "name": "Textile product mills", "value": 0.2083, "cat": "Goods"}, "val17": {"subcat": "Nondurable Goods", "name": "Textile mills", "value": 0.3063, "cat": "Goods"}, "val16": {"subcat": "Nondurable Goods", "name": "Food manufacturing", "value": 1.5388, "cat": "Goods"}, "val15": {"subcat": "Durable Goods", "name": "Miscellaneous durable goods manufacturing", "value": 0.6921, "cat": "Goods"}, "val14": {"subcat": "Durable Goods", "name": "Furniture and related products", "value": 0.6152000000000001, "cat": "Goods"}, "val13": {"subcat": "Durable Goods", "name": "Transportation equipment", "value": 1.8768, "cat": "Goods"}, "val12": {"subcat": "Durable Goods", "name": "Electrical equipment and appliances", "value": 0.5177, "cat": "Goods"}, "val11": {"subcat": "Durable Goods", "name": "Computer and electronic products", "value": 1.6134000000000002, "cat": "Goods"}, "val10": {"subcat": "Durable Goods", "name": "Machinery", "value": 1.2835, "cat": "Goods"}, "val90": {"subcat": "Local", "name": "Other local government", "value": 0.966, "cat": "Government"}, "val80": {"subcat": "Federal", "name": "Other Federal government", "value": 1.1567, "cat": "Government"}, "val81": {"subcat": "State", "name": "State government education", "value": 2.1865, "cat": "Government"}, "val82": {"subcat": "State", "name": "State hospitals", "value": 0.3485, "cat": "Government"}, "val83": {"subcat": "State", "name": "State government general administration", "value": 1.905, "cat": "Government"}, "val84": {"subcat": "State", "name": "Other State government", "value": 0.5514, "cat": "Government"}, "val85": {"subcat": "Local", "name": "Local government education", "value": 7.5752, "cat": "Government"}, "val86": {"subcat": "Local", "name": "Local government utilities", "value": 0.2315, "cat": "Government"}, "val87": {"subcat": "Local", "name": "Local government transportation", "value": 0.24430000000000002, "cat": "Government"}, "val88": {"subcat": "Local", "name": "Local hospitals", "value": 0.6367999999999999, "cat": "Government"}, "val89": {"subcat": "Local", "name": "Local government general administration", "value": 3.9538, "cat": "Government"}, "val79": {"subcat": "Federal", "name": "U.S. Postal Service", "value": 0.8652000000000001, "cat": "Government"}, "val78": {"subcat": "Federal", "name": "Department of Defense", "value": 0.49989999999999996, "cat": "Government"}, "val75": {"subcat": "Other services", "name": "Personal and laundry services", "value": 1.2583, "cat": "Services"}, "val74": {"subcat": "Other services", "name": "Repair and maintenance", "value": 1.2519, "cat": "Services"}, "val77": {"subcat": "Federal", "name": "Federal hospitals", "value": 0.2295, "cat": "Government"}, "val76": {"subcat": "Other services", "name": "Membership associations and organizations", "value": 2.8226, "cat": "Services"}, "val71": {"subcat": "Leisure and hospitality", "name": "Amusements, gambling, and recreation", "value": 1.3145, "cat": "Services"}, "val70": {"subcat": "Leisure and hospitality", "name": "Museums, historical sites, and similar institutions", "value": 0.1158, "cat": "Services"}, "val73": {"subcat": "Leisure and hospitality", "name": "Food services and drinking places", "value": 8.3825, "cat": "Services"}, "val72": {"subcat": "Leisure and hospitality", "name": "Accommodation", "value": 1.7758, "cat": "Services"}}, {"val68": {"subcat": "Education and health services", "name": "Social assistance", "value": 1.7090999999999998, "cat": "Services"}, "val69": {"subcat": "Leisure and hospitality", "name": "Performing arts and spectator sports", "value": 0.3533, "cat": "Services"}, "val66": {"subcat": "Education and health services", "name": "Hospitals", "value": 3.8501999999999996, "cat": "Services"}, "val67": {"subcat": "Education and health services", "name": "Nursing and residential care facilities", "value": 2.4720999999999997, "cat": "Services"}, "val64": {"subcat": "Professional and business services", "name": "Waste management and remediation services", "value": 0.2919, "cat": "Services"}, "val65": {"subcat": "Education and health services", "name": "Ambulatory health care services", "value": 4.144100000000001, "cat": "Services"}, "val62": {"subcat": "Financial activities", "name": "Lessors of nonfinancial intangible assets", "value": 0.0238, "cat": "Services"}, "val63": {"subcat": "Professional and business services", "name": "Administrative and support services", "value": 6.9141, "cat": "Services"}, "val60": {"subcat": "Financial activities", "name": "Real estate", "value": 1.2515999999999998, "cat": "Services"}, "val61": {"subcat": "Financial activities", "name": "Rental and leasing services", "value": 0.6222000000000001, "cat": "Services"}, "val59": {"subcat": "Financial activities", "name": "Insurance carriers and related activities", "value": 2.3003, "cat": "Services"}, "val58": {"subcat": "Financial activities", "name": "Credit intermediation and related activities", "value": 2.4800999999999997, "cat": "Services"}, "val53": {"subcat": "Information", "name": "Broadcasting, except Internet", "value": 0.31460000000000005, "cat": "Services"}, "val52": {"subcat": "Information", "name": "Motion picture and sound recording industries", "value": 0.36469999999999997, "cat": "Services"}, "val51": {"subcat": "Information", "name": "Publishing industries, except Internet", "value": 0.9688, "cat": "Services"}, "val50": {"subcat": "Transportation and warehousing", "name": "Warehousing and storage", "value": 0.4679, "cat": "Services"}, "val57": {"subcat": "Financial activities", "name": "Monetary authorities - central bank", "value": 0.0215, "cat": "Services"}, "val56": {"subcat": "Information", "name": "Other information services", "value": 0.0888, "cat": "Services"}, "val55": {"subcat": "Information", "name": "Data processing, hosting and related services", "value": 0.273, "cat": "Services"}, "val54": {"subcat": "Information", "name": "Telecommunications", "value": 1.1362, "cat": "Services"}, "val9": {"subcat": "Durable Goods", "name": "Fabricated metal products", "value": 1.7290999999999999, "cat": "Goods"}, "val8": {"subcat": "Durable Goods", "name": "Primary metals", "value": 0.6447999999999999, "cat": "Goods"}, "year": 1997, "val3": {"subcat": "Construction", "name": "Construction of buildings", "value": 1.4630999999999998, "cat": "Goods"}, "val2": {"subcat": "Mining and logging", "name": "Support activities for mining", "value": 0.1869, "cat": "Goods"}, "val1": {"subcat": "Mining and logging", "name": "Mining, except oil and gas", "value": 0.2465, "cat": "Goods"}, "val0": {"subcat": "Mining and logging", "name": "Oil and gas extraction", "value": 0.1431, "cat": "Goods"}, "val7": {"subcat": "Durable Goods", "name": "Nonmetallic mineral products", "value": 0.5283, "cat": "Goods"}, "val6": {"subcat": "Durable Goods", "name": "Wood products", "value": 0.6047, "cat": "Goods"}, "val5": {"subcat": "Construction", "name": "Specialty trade contractors", "value": 3.6394, "cat": "Goods"}, "val4": {"subcat": "Construction", "name": "Heavy and civil engineering construction", "value": 0.8356, "cat": "Goods"}, "val44": {"subcat": "Transportation and warehousing", "name": "Truck transportation", "value": 1.3275, "cat": "Services"}, "val45": {"subcat": "Transportation and warehousing", "name": "Transit and ground passenger transportation", "value": 0.3558, "cat": "Services"}, "val46": {"subcat": "Transportation and warehousing", "name": "Pipeline transportation", "value": 0.0482, "cat": "Services"}, "val47": {"subcat": "Transportation and warehousing", "name": "Scenic and sightseeing transportation", "value": 0.025, "cat": "Services"}, "val40": {"subcat": "Retail trade", "name": "Nonstore retailers", "value": 0.4471, "cat": "Services"}, "val41": {"subcat": "Transportation and warehousing", "name": "Air transportation", "value": 0.5501, "cat": "Services"}, "val42": {"subcat": "Transportation and warehousing", "name": "Rail transportation", "value": 0.22290000000000001, "cat": "Services"}, "val43": {"subcat": "Transportation and warehousing", "name": "Water transportation", "value": 0.0497, "cat": "Services"}, "val48": {"subcat": "Transportation and warehousing", "name": "Support activities for transportation", "value": 0.4833, "cat": "Services"}, "val49": {"subcat": "Transportation and warehousing", "name": "Couriers and messengers", "value": 0.5497000000000001, "cat": "Services"}, "val31": {"subcat": "Retail trade", "name": "Electronics and appliance stores", "value": 0.5831000000000001, "cat": "Services"}, "val30": {"subcat": "Retail trade", "name": "Furniture and home furnishings stores", "value": 0.4929, "cat": "Services"}, "val33": {"subcat": "Retail trade", "name": "Food and beverage stores", "value": 2.9563, "cat": "Services"}, "val32": {"subcat": "Retail trade", "name": "Building material and garden supply stores", "value": 1.0454, "cat": "Services"}, "val35": {"subcat": "Retail trade", "name": "Gasoline stations", "value": 0.9612999999999999, "cat": "Services"}, "val34": {"subcat": "Retail trade", "name": "Health and personal care stores", "value": 0.8675, "cat": "Services"}, "val37": {"subcat": "Retail trade", "name": "Sporting goods, hobby, book, and music stores", "value": 0.5672, "cat": "Services"}, "val36": {"subcat": "Retail trade", "name": "Clothing and clothing accessories stores", "value": 1.2606, "cat": "Services"}, "val39": {"subcat": "Retail trade", "name": "Miscellaneous store retailers", "value": 0.9301, "cat": "Services"}, "val38": {"subcat": "Retail trade", "name": "General merchandise stores", "value": 2.6925, "cat": "Services"}, "val22": {"subcat": "Nondurable Goods", "name": "Petroleum and coal products", "value": 0.137, "cat": "Goods"}, "val23": {"subcat": "Nondurable Goods", "name": "Chemicals", "value": 0.9914, "cat": "Goods"}, "val20": {"subcat": "Nondurable Goods", "name": "Paper and paper products", "value": 0.6293, "cat": "Goods"}, "val21": {"subcat": "Nondurable Goods", "name": "Printing and related support activities", "value": 0.8271000000000001, "cat": "Goods"}, "val26": {"subcat": "Wholesale trade", "name": "Durable goods", "value": 3.1144000000000003, "cat": "Services"}, "val27": {"subcat": "Wholesale trade", "name": "Nondurable goods", "value": 2.0254000000000003, "cat": "Services"}, "val24": {"subcat": "Nondurable Goods", "name": "Plastics and rubber products", "value": 0.94, "cat": "Goods"}, "val25": {"subcat": "Nondurable Goods", "name": "Leather and allied products", "value": 0.0872, "cat": "Goods"}, "val28": {"subcat": "Wholesale trade", "name": "Electronic markets and agents and brokers", "value": 0.5921000000000001, "cat": "Services"}, "val29": {"subcat": "Retail trade", "name": "Motor vehicle and parts dealers", "value": 1.7290999999999999, "cat": "Services"}, "val19": {"subcat": "Nondurable Goods", "name": "Apparel", "value": 0.6605, "cat": "Goods"}, "val18": {"subcat": "Nondurable Goods", "name": "Textile product mills", "value": 0.2352, "cat": "Goods"}, "val17": {"subcat": "Nondurable Goods", "name": "Textile mills", "value": 0.43560000000000004, "cat": "Goods"}, "val16": {"subcat": "Nondurable Goods", "name": "Food manufacturing", "value": 1.5575999999999999, "cat": "Goods"}, "val15": {"subcat": "Durable Goods", "name": "Miscellaneous durable goods manufacturing", "value": 0.7235, "cat": "Goods"}, "val14": {"subcat": "Durable Goods", "name": "Furniture and related products", "value": 0.6264, "cat": "Goods"}, "val13": {"subcat": "Durable Goods", "name": "Transportation equipment", "value": 2.0718, "cat": "Goods"}, "val12": {"subcat": "Durable Goods", "name": "Electrical equipment and appliances", "value": 0.5889, "cat": "Goods"}, "val11": {"subcat": "Durable Goods", "name": "Computer and electronic products", "value": 1.8423, "cat": "Goods"}, "val10": {"subcat": "Durable Goods", "name": "Machinery", "value": 1.519, "cat": "Goods"}, "val90": {"subcat": "Local", "name": "Other local government", "value": 0.8733, "cat": "Government"}, "val80": {"subcat": "Federal", "name": "Other Federal government", "value": 1.1218, "cat": "Government"}, "val81": {"subcat": "State", "name": "State government education", "value": 1.9045, "cat": "Government"}, "val82": {"subcat": "State", "name": "State hospitals", "value": 0.3512, "cat": "Government"}, "val83": {"subcat": "State", "name": "State government general administration", "value": 1.8211, "cat": "Government"}, "val84": {"subcat": "State", "name": "Other State government", "value": 0.5015, "cat": "Government"}, "val85": {"subcat": "Local", "name": "Local government education", "value": 6.8369, "cat": "Government"}, "val86": {"subcat": "Local", "name": "Local government utilities", "value": 0.22619999999999998, "cat": "Government"}, "val87": {"subcat": "Local", "name": "Local government transportation", "value": 0.20980000000000001, "cat": "Government"}, "val88": {"subcat": "Local", "name": "Local hospitals", "value": 0.6316, "cat": "Government"}, "val89": {"subcat": "Local", "name": "Local government general administration", "value": 3.6261, "cat": "Government"}, "val79": {"subcat": "Federal", "name": "U.S. Postal Service", "value": 0.8729, "cat": "Government"}, "val78": {"subcat": "Federal", "name": "Department of Defense", "value": 0.5679, "cat": "Government"}, "val75": {"subcat": "Other services", "name": "Personal and laundry services", "value": 1.1865999999999999, "cat": "Services"}, "val74": {"subcat": "Other services", "name": "Repair and maintenance", "value": 1.1805999999999999, "cat": "Services"}, "val77": {"subcat": "Federal", "name": "Federal hospitals", "value": 0.2243, "cat": "Government"}, "val76": {"subcat": "Other services", "name": "Membership associations and organizations", "value": 2.5305999999999997, "cat": "Services"}, "val71": {"subcat": "Leisure and hospitality", "name": "Amusements, gambling, and recreation", "value": 1.1675, "cat": "Services"}, "val70": {"subcat": "Leisure and hospitality", "name": "Museums, historical sites, and similar institutions", "value": 0.09509999999999999, "cat": "Services"}, "val73": {"subcat": "Leisure and hospitality", "name": "Food services and drinking places", "value": 7.7285, "cat": "Services"}, "val72": {"subcat": "Leisure and hospitality", "name": "Accommodation", "value": 1.7428, "cat": "Services"}}, {"val68": {"subcat": "Education and health services", "name": "Social assistance", "value": 1.3916, "cat": "Services"}, "val69": {"subcat": "Leisure and hospitality", "name": "Performing arts and spectator sports", "value": 0.29560000000000003, "cat": "Services"}, "val66": {"subcat": "Education and health services", "name": "Hospitals", "value": 3.7285999999999997, "cat": "Services"}, "val67": {"subcat": "Education and health services", "name": "Nursing and residential care facilities", "value": 2.1780999999999997, "cat": "Services"}, "val64": {"subcat": "Professional and business services", "name": "Waste management and remediation services", "value": 0.2545, "cat": "Services"}, "val65": {"subcat": "Education and health services", "name": "Ambulatory health care services", "value": 3.4697, "cat": "Services"}, "val62": {"subcat": "Financial activities", "name": "Lessors of nonfinancial intangible assets", "value": 0.0179, "cat": "Services"}, "val63": {"subcat": "Professional and business services", "name": "Administrative and support services", "value": 5.1053999999999995, "cat": "Services"}, "val60": {"subcat": "Financial activities", "name": "Real estate", "value": 1.1704, "cat": "Services"}, "val61": {"subcat": "Financial activities", "name": "Rental and leasing services", "value": 0.5145, "cat": "Services"}, "val59": {"subcat": "Financial activities", "name": "Insurance carriers and related activities", "value": 2.1826, "cat": "Services"}, "val58": {"subcat": "Financial activities", "name": "Credit intermediation and related activities", "value": 2.3939, "cat": "Services"}, "val53": {"subcat": "Information", "name": "Broadcasting, except Internet", "value": 0.2855, "cat": "Services"}, "val52": {"subcat": "Information", "name": "Motion picture and sound recording industries", "value": 0.2693, "cat": "Services"}, "val51": {"subcat": "Information", "name": "Publishing industries, except Internet", "value": 0.8817, "cat": "Services"}, "val50": {"subcat": "Transportation and warehousing", "name": "Warehousing and storage", "value": 0.4169, "cat": "Services"}, "val57": {"subcat": "Financial activities", "name": "Monetary authorities - central bank", "value": 0.0235, "cat": "Services"}, "val56": {"subcat": "Information", "name": "Other information services", "value": 0.0584, "cat": "Services"}, "val55": {"subcat": "Information", "name": "Data processing, hosting and related services", "value": 0.22290000000000001, "cat": "Services"}, "val54": {"subcat": "Information", "name": "Telecommunications", "value": 0.9741000000000001, "cat": "Services"}, "val9": {"subcat": "Durable Goods", "name": "Fabricated metal products", "value": 1.5268, "cat": "Goods"}, "val8": {"subcat": "Durable Goods", "name": "Primary metals", "value": 0.6197, "cat": "Goods"}, "year": 1993, "val3": {"subcat": "Construction", "name": "Construction of buildings", "value": 1.2675, "cat": "Goods"}, "val2": {"subcat": "Mining and logging", "name": "Support activities for mining", "value": 0.1666, "cat": "Goods"}, "val1": {"subcat": "Mining and logging", "name": "Mining, except oil and gas", "value": 0.25639999999999996, "cat": "Goods"}, "val0": {"subcat": "Mining and logging", "name": "Oil and gas extraction", "value": 0.167, "cat": "Goods"}, "val7": {"subcat": "Durable Goods", "name": "Nonmetallic mineral products", "value": 0.4955, "cat": "Goods"}, "val6": {"subcat": "Durable Goods", "name": "Wood products", "value": 0.543, "cat": "Goods"}, "val5": {"subcat": "Construction", "name": "Specialty trade contractors", "value": 2.9031, "cat": "Goods"}, "val4": {"subcat": "Construction", "name": "Heavy and civil engineering construction", "value": 0.7546, "cat": "Goods"}, "val44": {"subcat": "Transportation and warehousing", "name": "Truck transportation", "value": 1.1756, "cat": "Services"}, "val45": {"subcat": "Transportation and warehousing", "name": "Transit and ground passenger transportation", "value": 0.30639999999999995, "cat": "Services"}, "val46": {"subcat": "Transportation and warehousing", "name": "Pipeline transportation", "value": 0.0578, "cat": "Services"}, "val47": {"subcat": "Transportation and warehousing", "name": "Scenic and sightseeing transportation", "value": 0.0205, "cat": "Services"}, "val40": {"subcat": "Retail trade", "name": "Nonstore retailers", "value": 0.4014, "cat": "Services"}, "val41": {"subcat": "Transportation and warehousing", "name": "Air transportation", "value": 0.5157999999999999, "cat": "Services"}, "val42": {"subcat": "Transportation and warehousing", "name": "Rail transportation", "value": 0.238, "cat": "Services"}, "val43": {"subcat": "Transportation and warehousing", "name": "Water transportation", "value": 0.0531, "cat": "Services"}, "val48": {"subcat": "Transportation and warehousing", "name": "Support activities for transportation", "value": 0.391, "cat": "Services"}, "val49": {"subcat": "Transportation and warehousing", "name": "Couriers and messengers", "value": 0.4205, "cat": "Services"}, "val31": {"subcat": "Retail trade", "name": "Electronics and appliance stores", "value": 0.4717, "cat": "Services"}, "val30": {"subcat": "Retail trade", "name": "Furniture and home furnishings stores", "value": 0.42560000000000003, "cat": "Services"}, "val33": {"subcat": "Retail trade", "name": "Food and beverage stores", "value": 2.7905, "cat": "Services"}, "val32": {"subcat": "Retail trade", "name": "Building material and garden supply stores", "value": 0.9115, "cat": "Services"}, "val35": {"subcat": "Retail trade", "name": "Gasoline stations", "value": 0.8911, "cat": "Services"}, "val34": {"subcat": "Retail trade", "name": "Health and personal care stores", "value": 0.7898999999999999, "cat": "Services"}, "val37": {"subcat": "Retail trade", "name": "Sporting goods, hobby, book, and music stores", "value": 0.4793, "cat": "Services"}, "val36": {"subcat": "Retail trade", "name": "Clothing and clothing accessories stores", "value": 1.2621, "cat": "Services"}, "val39": {"subcat": "Retail trade", "name": "Miscellaneous store retailers", "value": 0.7687999999999999, "cat": "Services"}, "val38": {"subcat": "Retail trade", "name": "General merchandise stores", "value": 2.4581999999999997, "cat": "Services"}, "val22": {"subcat": "Nondurable Goods", "name": "Petroleum and coal products", "value": 0.144, "cat": "Goods"}, "val23": {"subcat": "Nondurable Goods", "name": "Chemicals", "value": 1.0187, "cat": "Goods"}, "val20": {"subcat": "Nondurable Goods", "name": "Paper and paper products", "value": 0.6372000000000001, "cat": "Goods"}, "val21": {"subcat": "Nondurable Goods", "name": "Printing and related support activities", "value": 0.7892, "cat": "Goods"}, "val26": {"subcat": "Wholesale trade", "name": "Durable goods", "value": 2.7214, "cat": "Services"}, "val27": {"subcat": "Wholesale trade", "name": "Nondurable goods", "value": 1.8962999999999999, "cat": "Services"}, "val24": {"subcat": "Nondurable Goods", "name": "Plastics and rubber products", "value": 0.8623999999999999, "cat": "Goods"}, "val25": {"subcat": "Nondurable Goods", "name": "Leather and allied products", "value": 0.1167, "cat": "Goods"}, "val28": {"subcat": "Wholesale trade", "name": "Electronic markets and agents and brokers", "value": 0.523, "cat": "Services"}, "val29": {"subcat": "Retail trade", "name": "Motor vehicle and parts dealers", "value": 1.5132, "cat": "Services"}, "val19": {"subcat": "Nondurable Goods", "name": "Apparel", "value": 0.8365, "cat": "Goods"}, "val18": {"subcat": "Nondurable Goods", "name": "Textile product mills", "value": 0.2366, "cat": "Goods"}, "val17": {"subcat": "Nondurable Goods", "name": "Textile mills", "value": 0.4773, "cat": "Goods"}, "val16": {"subcat": "Nondurable Goods", "name": "Food manufacturing", "value": 1.5395999999999999, "cat": "Goods"}, "val15": {"subcat": "Durable Goods", "name": "Miscellaneous durable goods manufacturing", "value": 0.7042999999999999, "cat": "Goods"}, "val14": {"subcat": "Durable Goods", "name": "Furniture and related products", "value": 0.5847, "cat": "Goods"}, "val13": {"subcat": "Durable Goods", "name": "Transportation equipment", "value": 1.9039000000000001, "cat": "Goods"}, "val12": {"subcat": "Durable Goods", "name": "Electrical equipment and appliances", "value": 0.5798, "cat": "Goods"}, "val11": {"subcat": "Durable Goods", "name": "Computer and electronic products", "value": 1.6434000000000002, "cat": "Goods"}, "val10": {"subcat": "Durable Goods", "name": "Machinery", "value": 1.3487, "cat": "Goods"}, "val90": {"subcat": "Local", "name": "Other local government", "value": 0.794, "cat": "Government"}, "val80": {"subcat": "Federal", "name": "Other Federal government", "value": 1.3419, "cat": "Government"}, "val81": {"subcat": "State", "name": "State government education", "value": 1.8564, "cat": "Government"}, "val82": {"subcat": "State", "name": "State hospitals", "value": 0.4111, "cat": "Government"}, "val83": {"subcat": "State", "name": "State government general administration", "value": 1.7562, "cat": "Government"}, "val84": {"subcat": "State", "name": "Other State government", "value": 0.498, "cat": "Government"}, "val85": {"subcat": "Local", "name": "Local government education", "value": 6.2627, "cat": "Government"}, "val86": {"subcat": "Local", "name": "Local government utilities", "value": 0.2322, "cat": "Government"}, "val87": {"subcat": "Local", "name": "Local government transportation", "value": 0.2027, "cat": "Government"}, "val88": {"subcat": "Local", "name": "Local hospitals", "value": 0.6741, "cat": "Government"}, "val89": {"subcat": "Local", "name": "Local government general administration", "value": 3.3779, "cat": "Government"}, "val79": {"subcat": "Federal", "name": "U.S. Postal Service", "value": 0.8042, "cat": "Government"}, "val78": {"subcat": "Federal", "name": "Department of Defense", "value": 0.6502, "cat": "Government"}, "val75": {"subcat": "Other services", "name": "Personal and laundry services", "value": 1.1168, "cat": "Services"}, "val74": {"subcat": "Other services", "name": "Repair and maintenance", "value": 0.9986, "cat": "Services"}, "val77": {"subcat": "Federal", "name": "Federal hospitals", "value": 0.2363, "cat": "Government"}, "val76": {"subcat": "Other services", "name": "Membership associations and organizations", "value": 2.2479, "cat": "Services"}, "val71": {"subcat": "Leisure and hospitality", "name": "Amusements, gambling, and recreation", "value": 0.9631000000000001, "cat": "Services"}, "val70": {"subcat": "Leisure and hospitality", "name": "Museums, historical sites, and similar institutions", "value": 0.08009999999999999, "cat": "Services"}, "val73": {"subcat": "Leisure and hospitality", "name": "Food services and drinking places", "value": 6.9857, "cat": "Services"}, "val72": {"subcat": "Leisure and hospitality", "name": "Accommodation", "value": 1.6002, "cat": "Services"}}];

var current_subset = "All"; //Needed a variable to keep track of which subset the user is looking, intially it is everything

var n = 91, // number of job types per year (layers), this SHOULD be figured out programatically
	m = all_data.length, // number of years of data
    stack = d3.layout.stack(),
	layers = stack(organizeData(all_data, false, "All")), //use the stack layout with the data in the needed format, munged by organizeData function below
    x_max = d3.max(layers, function(layer) { return d3.max(layer, function(d) { return d.y0 + d.y; }); }), //find the max value for each bar
	colors = createColors(); //use function to create color array for categories and subcategories
	
var margin = {top: 50, right: 10, bottom: 20, left: 250},
    width = 1060 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

var y = d3.scale.ordinal() //the y axis is the years
    .domain(d3.range(m))
    .rangeRoundBands([0, height], .08);

var x = d3.scale.linear() //the x axis is the jobs number
    .domain([0, x_max])
    .range([0, width]);

var y_axis = d3.svg.axis() //setup the y axis creation function to be called later
    .scale(y)
    .tickSize(0)
    .tickPadding(10)
	.tickValues(all_data.map(function(d) {return d.year;}))
    .orient("left");
	
var svg = d3.select("body").append("svg") //Create svg to hold hold graphics
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
   .append("g") //Create groups for bar chart
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
	
var svg_title = d3.select("svg").append("g") //create group to hold category titles
	.attr("transform", "translate(" + 0 + "," + (margin.top+20) + ")")
	.attr("class", "categories");
	
var titles = svg_title.selectAll("categories") //add category titles groups
	.data(createTitleArray(all_data[0])) //add data, munged using createTitleArray function into correct format
   .enter().append("g");
	
var text = titles.selectAll("text") //add category titles and format appropriately
	.data(function(d) { return d; })
  .enter().append("text")
	.attr("x", 0)
	.attr("y", function(d) {return d.space;})
	.style("fill", function(d) {return d.color; })
	.style("font-size", function(d) {return d.size; })
	.text(function(d) {return d.name; })
	.on("click", function(d) {subset(d.name)});

var layer = svg.selectAll(".layers") //add layers for bar chart
    .data(layers)
  .enter().append("g")
    .attr("class", "layer");

var rect = createRect(); //call function to create the rectangle svg elements representing the pieces of the bars

var tooltip = d3.select("body").append("div") //create a div to hold the tooltip info
    .attr("class", "tooltip")               
    .style("opacity", 0);
	
rect.transition() //transition so that when the page is loaded, the bars "grow" from the left side over
    .delay(function(d, i) { return i * 10; })
    .attr("x", function(d) { return x(d.y0); })
    .attr("width", function(d) { return x(d.y); });

svg.append("g") //add an svg group for the y_axis labels (the years)
	.attr("class", "y axis")
    .call(y_axis);
	
//function that creates the rectangles for each piece of the bar
function createRect() {
	var rect = layer.selectAll("rect")
		.data(function(d) { return d; }) //bind data
	  .enter().append("rect") //add the rectanges with the appropriate attributes
		.attr("x", 0)
		.attr("y", function(d) { return y(d.x); })
		.attr("width", 0)
		.attr("height", y.rangeBand())
		.attr("class", function(d) { return d.title; })
		.style("stroke", "white")
		.style("fill", function(d) {return colors[d.subcat];})
		.on("mouseover", function(d) { //show the tooltip and highlight the matching elements in other years when the user mouses over a reactangle
					var elements = document.getElementsByClassName(d.title);
					for (var i=0; i<elements.length; i++) {
						elements[i].style.fill = "#984ea3";
					}
					var mode = checkMode();
					var y_val = d.y;
					if (mode === 'normal') {
						var norm = d3.format(".1%");
						y_val = norm(y_val);
					}
					else {
						var rd = d3.format(".1f");
						y_val = rd(y_val);
					}
					tooltip.transition()        
						.duration(200)      
						.style("opacity", 1);
					var units = "";
					if (mode !== 'normal') {
						units = " million";
					}
					tooltip.html("<b>Industry:</b> " + d.title + "<br/>"  + "<b>Jobs:</b> " + y_val + units)  
						.style("left", (d3.event.pageX - 180) + "px")     
						.style("top", (d3.event.pageY - 120) + "px"); })
		.on("mousemove", function(d) { //move the tooltip as the mouse moves
					tooltip.style("left", (d3.event.pageX - 180) + "px")     
						.style("top", (d3.event.pageY - 120) + "px"); })
		.on("mouseout", function(d) { //fade out the tooltip as the mousse leaves a rectangle
					var elements = document.getElementsByClassName(d.title);
					for (var i=0; i<elements.length; i++) {
						elements[i].style.fill = colors[d.subcat];
					}
					tooltip.transition()        
						.duration(500)      
						.style("opacity", 0);  })
		;
	return rect
}

//helper function that checks the radio button to see which one is selected, and returns that value
function checkMode() {	
	var rad_buttons = document.getElementsByName('mode');
	for (var i=0; i<rad_buttons.length; i++) {
		if (rad_buttons[i].checked) {
			return rad_buttons[i].value;
		}
	}
	return "none";
}

//helper function that removes existing rectangles and adds in new ones based on the subset passed in
function subset(subset_to_show) {
	current_subset = subset_to_show; //update variable to reflect current subset being shown
	var is_normal = false; 
	if (checkMode() === "normal") { //see if normalized mode is selected
		is_normal = true;
	}
	//recalculate necessary values, remove existing rectanges, and create new ones for the subset only
	layers = stack(organizeData(all_data, is_normal, subset_to_show));
	x_max = d3.max(layers, function(layer) { return d3.max(layer, function(d) { return d.y0 + d.y; }); });
	x = d3.scale.linear().domain([0, x_max]).range([0, width]);
	svg.selectAll(".layer").remove();
	layer = svg.selectAll(".layers")
		.data(layers)
	   .enter().append("g")
		.attr("class", "layer");
	rect = createRect();
	rect.transition()
		.attr("x", function(d) { return x(d.y0); })
		.attr("width", function(d) { return x(d.y); });
}

//When the mode is changed (a radio button is selected, either absolute or normalized), call the transitionNormal function
d3.selectAll("[name=mode]").on("change", transitionNormal);

//Changes the mode of the bars, either to normal or absolute
function transitionNormal() {
	is_normalized = (this.value === "normal");
	layers = stack(organizeData(all_data, is_normalized, current_subset)); //recreate layers
	x_max = d3.max(layers, function(layer) { return d3.max(layer, function(d) { return d.y0 + d.y; }); }); //recalculate max x value
	x = d3.scale.linear().domain([0, x_max]).range([0, width]); //recalculate x scale
	svg.selectAll(".layer").data(layers); //rebind data
	rect.data(function(d) { return d; });
	rect.transition() //transition to new mode
		.attr("x", function(d) { return x(d.y0); })
		.attr("width", function(d) { return x(d.y); });
}

//Creates colors for the subcategories, based on colors chosen for categories and pre-defined ranges
function createColors() {
	var colors = {"Government": "#2b8cbe", "Goods": "#a50f15", "Services": "#006d2c"};
	var subs = {};
	var ranges = {"Government": {"light": "#bdc9e1", "dark": "#74a9cf"}, 
					"Goods": {"light": "#fcae91", "dark": "#de2d26"}, 
					"Services": {"light": "#b2e2e2", "dark": "#2ca25f"}};
	var subcats = getSubcats(all_data[0]);
	//go through the three categories, and create a linear scale of colors for each, based on lightest and darkest values defined above
	for (var cat in subcats) {
		var subcolors = d3.scale.linear()
			.domain([0, subcats[cat].length - 1])
			.range([ranges[cat]["light"], ranges[cat]["dark"]]);
		var new_range = changeRange(subcats[cat].length); //mix up colors so it doesn't grade light to dark
		for (var i=0; i<subcats[cat].length; i++) {
			colors[subcats[cat][i]] = subcolors(new_range[i]); //add colors for each subcategory to array
		}
	}
	return colors;
}

//Creates the array of category/subcategory titles in the format required
function createTitleArray(year_data) {
	var subcats = getSubcats(year_data);
	var titles = [[{"name": "All", "size": "14px", "color": "black", "space": -25}]]; //add a category for All
	var title_colors = createColors();
	var spacing = -10; //spacing variable, to allow for extra space between the main categories
	//add each category and subcategory to the array
	for (var cat in subcats) {
		spacing = spacing + 10;
		titles[0].push({"name": cat, "size": "14px", "color": title_colors[cat], "space": spacing});
		spacing = spacing + 20;
		for (var i=0; i<subcats[cat].length; i++) {
			titles[0].push({"name": subcats[cat][i],"size": "10px", "color": title_colors[subcats[cat][i]], "space": spacing});
			spacing = spacing + 20;
		}
	}
	return titles;
}

//Helper function that creates a dictionary which holds the categories, and what subcategories are contained in that category 
function getSubcats(year_data) {
	var subcats = {"Goods": [], "Services": [], "Government": []};
	for (var i=0; i<n; i++) {
		if (!contains(subcats[year_data["val"+i]["cat"]], year_data["val"+i]["subcat"])) {
			subcats[year_data["val"+i]["cat"]].push(year_data["val"+i]["subcat"]);
		}
	}
	return subcats;
}

//Helper function to tell if an element already exists in an array
function contains(arr, elem) {
	for(var i=0; i<arr.length; i++) {
        if (arr[i] === elem) {
			return true;
		}
    }
	return false;
}

//Helper function to create an array of values, number passed in, mixed up (used to assign colors to categories so that they won't be in order)
function changeRange(num) {
	var arr = []
	for (var i=0; i<num; i+=2) {
		arr.push(i);
	}
	for (var i=1; i<num; i+=2) {
		arr.push(i);
	}
	return arr;
}

//Munges in the input data for the stacked bars, to return in the format required by the layers layout	
function organizeData(data, norm, subset) {
	var arr = [];
	var tot = [];
	var get_all = (subset === "All"); //Check if the user elected to see all data
	var sub_count = 0; //Used to count elements of subset
	for (var i=0; i<n; i++) {
		if (get_all || data[0]["val"+i]["cat"] === subset) {
			arr.push([]);
			sub_count = sub_count + 1;
		}
		else if (data[0]["val"+i]["subcat"] === subset) {
			arr.push([]);
			sub_count = sub_count + 1;
		}
		//go though each year
		for (var j=0; j<m; j++) {
			//add array value containing dictionary for each bar element and count total (needed if normalized mode is active)
			if (get_all || data[j]["val"+i]["cat"] === subset) {
				arr[sub_count-1].push({"x":j, "y": data[j]["val"+i]["value"], "title": data[j]["val"+i]["name"], "cat": data[j]["val"+i]["cat"], "subcat": data[j]["val"+i]["subcat"]});
				if (tot.length <= j) {
					tot[j] = data[j]["val"+i]["value"];
				}
				else {
					tot[j] = tot[j] + data[j]["val"+i]["value"];
				}
			}
			else if (data[j]["val"+i]["subcat"] === subset) {
				arr[sub_count-1].push({"x":j, "y": data[j]["val"+i]["value"], "title": data[j]["val"+i]["name"], "cat": data[j]["val"+i]["cat"], "subcat": data[j]["val"+i]["subcat"]});
				if (tot.length <= j) {
					tot[j] = data[j]["val"+i]["value"];
				}
				else {
					tot[j] = tot[j] + data[j]["val"+i]["value"];
				}
			}
		}
	}
	//if in normalized more, normalize values using totals calculated above
	if (norm) {
		for (var i=0; i<sub_count; i++) {
			for (var j=0; j<m; j++) {
				arr[i][j]["y"] = arr[i][j]["y"]/tot[j];
			}
		}
	}
	return arr;
}
</script>
Click on the job categories/industries at left to filter for only those jobs. Change the view from absolute to normalized (percent of jobs) 
through the radio button at the top right.
</body>